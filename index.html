<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>4-Player Chess Clock</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useRef } = React;

    // Lucide Icons as SVG components
    const Play = () => (
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <polygon points="6 3 20 12 6 21 6 3"></polygon>
      </svg>
    );

    const Pause = () => (
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <rect x="14" y="4" width="4" height="16" rx="1"></rect>
        <rect x="6" y="4" width="4" height="16" rx="1"></rect>
      </svg>
    );

    const RotateCcw = () => (
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path>
        <path d="M3 3v5h5"></path>
      </svg>
    );

    const Settings = () => (
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
        <path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"></path>
        <circle cx="12" cy="12" r="3"></circle>
      </svg>
    );

    const App = () => {
      const [times, setTimes] = useState([600, 600, 600, 600]);
      const [activePlayer, setActivePlayer] = useState(null);
      const [isRunning, setIsRunning] = useState(false);
      const [showSettings, setShowSettings] = useState(false);
      const [baseTime, setBaseTime] = useState(10);
      const [increment, setIncrement] = useState(0);
      const [showQuickTime, setShowQuickTime] = useState(false);
      const intervalRef = useRef(null);

      const playerColors = ['bg-blue-500', 'bg-green-500', 'bg-red-500', 'bg-yellow-500'];
      const playerNames = ['Player 1', 'Player 2', 'Player 3', 'Player 4'];

      useEffect(() => {
        if (isRunning && activePlayer !== null) {
          intervalRef.current = setInterval(() => {
            setTimes(prevTimes => {
              const newTimes = [...prevTimes];
              if (newTimes[activePlayer] > 0) {
                newTimes[activePlayer] -= 1;
              } else {
                setIsRunning(false);
                clearInterval(intervalRef.current);
              }
              return newTimes;
            });
          }, 1000);
        } else {
          if (intervalRef.current) {
            clearInterval(intervalRef.current);
          }
        }

        return () => {
          if (intervalRef.current) {
            clearInterval(intervalRef.current);
          }
        };
      }, [isRunning, activePlayer]);

      const formatTime = (seconds) => {
        const mins = Math.floor(seconds / 60);
        const secs = seconds % 60;
        return `${mins}:${secs.toString().padStart(2, '0')}`;
      };

      const handlePlayerClick = (playerIndex) => {
        if (times[playerIndex] <= 0) return;

        if (activePlayer === null) {
          setActivePlayer(playerIndex);
          setIsRunning(true);
        } else if (activePlayer === playerIndex) {
          setTimes(prevTimes => {
            const newTimes = [...prevTimes];
            newTimes[playerIndex] += increment;
            return newTimes;
          });
          
          const nextPlayer = (playerIndex + 1) % 4;
          setActivePlayer(nextPlayer);
        }
      };

      const handleReset = () => {
        setIsRunning(false);
        setActivePlayer(null);
        setTimes([baseTime * 60, baseTime * 60, baseTime * 60, baseTime * 60]);
        if (intervalRef.current) {
          clearInterval(intervalRef.current);
        }
      };

      const handlePause = () => {
        setIsRunning(!isRunning);
      };

      const applySettings = () => {
        handleReset();
        setShowSettings(false);
      };

      const setAllPlayerTimes = (minutes) => {
        const seconds = minutes * 60;
        setTimes([seconds, seconds, seconds, seconds]);
        setShowQuickTime(false);
      };

      const PlayerClock = ({ index, position }) => {
        const isActive = activePlayer === index;
        const isLowTime = times[index] < 60;
        const hasLost = times[index] <= 0;

        const positionClasses = {
          top: 'top-4 left-1/2 -translate-x-1/2',
          right: 'right-4 top-1/2 -translate-y-1/2',
          bottom: 'bottom-4 left-1/2 -translate-x-1/2',
          left: 'left-4 top-1/2 -translate-y-1/2'
        };

        const rotationClasses = {
          top: '',
          right: 'rotate-90',
          bottom: 'rotate-180',
          left: '-rotate-90'
        };

        return (
          <div 
            className={`absolute ${positionClasses[position]} ${rotationClasses[position]}`}
            onClick={() => handlePlayerClick(index)}
          >
            <div className={`
              w-40 h-32 rounded-lg cursor-pointer transition-all duration-200
              flex flex-col items-center justify-center
              ${isActive ? `${playerColors[index]} scale-110 shadow-2xl` : 'bg-gray-700 hover:bg-gray-600'}
              ${hasLost ? 'opacity-50' : ''}
              ${isLowTime && !hasLost ? 'animate-pulse' : ''}
            `}>
              <div className="text-white text-sm font-semibold mb-1">
                {playerNames[index]}
              </div>
              <div className={`text-white font-mono font-bold ${isActive ? 'text-4xl' : 'text-3xl'}`}>
                {formatTime(times[index])}
              </div>
              {hasLost && (
                <div className="text-white text-xs mt-1">TIME OUT</div>
              )}
            </div>
          </div>
        );
      };

      return (
        <div className="w-full h-screen bg-gray-900 flex items-center justify-center relative overflow-hidden">
          {showQuickTime && (
            <div className="absolute inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50">
              <div className="bg-gray-800 p-8 rounded-xl w-80">
                <h2 className="text-white text-2xl font-bold mb-6">Set Time for All Players</h2>
                
                <div className="grid grid-cols-3 gap-3 mb-4">
                  {[1, 3, 5, 10, 15, 20, 30, 45, 60].map(mins => (
                    <button
                      key={mins}
                      onClick={() => setAllPlayerTimes(mins)}
                      className="bg-blue-600 hover:bg-blue-700 text-white py-3 px-4 rounded font-semibold transition"
                    >
                      {mins} min
                    </button>
                  ))}
                </div>

                <button 
                  onClick={() => setShowQuickTime(false)}
                  className="w-full bg-gray-600 hover:bg-gray-700 text-white py-2 px-4 rounded transition"
                >
                  Cancel
                </button>
              </div>
            </div>
          )}

          {showSettings && (
            <div className="absolute inset-0 bg-black bg-opacity-80 flex items-center justify-center z-50">
              <div className="bg-gray-800 p-8 rounded-xl w-80">
                <h2 className="text-white text-2xl font-bold mb-6">Settings</h2>
                
                <div className="mb-4">
                  <label className="text-white block mb-2">Base Time (minutes)</label>
                  <input 
                    type="number" 
                    value={baseTime}
                    onChange={(e) => setBaseTime(parseInt(e.target.value) || 1)}
                    className="w-full p-2 rounded bg-gray-700 text-white"
                    min="1"
                    max="60"
                  />
                </div>

                <div className="mb-6">
                  <label className="text-white block mb-2">Increment (seconds)</label>
                  <input 
                    type="number" 
                    value={increment}
                    onChange={(e) => setIncrement(parseInt(e.target.value) || 0)}
                    className="w-full p-2 rounded bg-gray-700 text-white"
                    min="0"
                    max="30"
                  />
                </div>

                <div className="flex gap-3">
                  <button 
                    onClick={applySettings}
                    className="flex-1 bg-green-600 hover:bg-green-700 text-white py-2 px-4 rounded transition"
                  >
                    Apply
                  </button>
                  <button 
                    onClick={() => setShowSettings(false)}
                    className="flex-1 bg-gray-600 hover:bg-gray-700 text-white py-2 px-4 rounded transition"
                  >
                    Cancel
                  </button>
                </div>
              </div>
            </div>
          )}

          <PlayerClock index={0} position="top" />
          <PlayerClock index={1} position="right" />
          <PlayerClock index={2} position="bottom" />
          <PlayerClock index={3} position="left" />

          <div className="flex flex-col items-center gap-4">
            <div className="text-white text-xl font-semibold mb-2">
              {activePlayer === null ? 'Tap any player to start' : 
               isRunning ? `${playerNames[activePlayer]}'s turn` : 'Paused'}
            </div>
            
            <div className="flex gap-4">
              <button 
                onClick={handlePause}
                disabled={activePlayer === null}
                className="bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 disabled:cursor-not-allowed text-white p-4 rounded-full transition"
              >
                {isRunning ? <Pause /> : <Play />}
              </button>
              
              <button 
                onClick={handleReset}
                className="bg-red-600 hover:bg-red-700 text-white p-4 rounded-full transition"
              >
                <RotateCcw />
              </button>
              
              <button 
                onClick={() => setShowSettings(true)}
                className="bg-gray-600 hover:bg-gray-700 text-white p-4 rounded-full transition"
              >
                <Settings />
              </button>
            </div>

            <button
              onClick={() => setShowQuickTime(true)}
              className="mt-2 bg-purple-600 hover:bg-purple-700 text-white py-2 px-6 rounded-full transition text-sm font-semibold"
            >
              Change All Times
            </button>
          </div>

          <div className="absolute bottom-4 left-1/2 -translate-x-1/2 text-gray-400 text-sm text-center">
            Click on the active player's clock to end their turn
          </div>
        </div>
      );
    };

    ReactDOM.render(<App />, document.getElementById('root'));
  </script>
</body>
</html>